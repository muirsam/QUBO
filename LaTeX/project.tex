\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage{amsmath}
\usepackage[dvipsnames]{xcolor}
\usepackage{amsfonts}

% ========= Bibliography =========
% These lines load the `biblatex' package
% and read in the list of references from
% References.bib - take a look.
%
% To generate References.bib, I recommend https://www.mybib.com/
% rather than trying to write the .bib file yourself.
%
\usepackage{csquotes,biblatex}
\addbibresource{References.bib}
% ================================

\newtheorem{prop}{Proposition} % This defines a theorem-like environment. See https://www.overleaf.com/learn/latex/theorems_and_proofs
\newtheorem{lem}[prop]{Lemma}
\newtheorem{thm}[prop]{Theorem}
\newtheorem{cor}[prop]{Corollary}
\newtheorem{defn}[prop]{Definition}

\title{Quadratic Unconstrained Binary Optimization}
\author{Sam Muir }
\date{June 2024}

\begin{document}

\maketitle

\section{Introduction}

Placeholder text from Project booklet: \\
\colorbox{BurntOrange}{The Quadratic Unconstrained Binary Optimization (QUBO) problem consists of finding a binary}
\colorbox{BurntOrange}{vector (i.e., all the entries are either 0 or 1) that minimizes a quadratic objective function. Many}
\colorbox{BurntOrange}{combinatorial optimization problems, which play an important role in computer science, operations}
\colorbox{BurntOrange}{research, physics and chemistry, can be posed as QUBO problems. The goal of the project is to solve}
\colorbox{BurntOrange}{QUBO reformulations of such problems and to analyze the feasibility of using quantum annealers for}
\colorbox{BurntOrange}{real-world applications. Of particular interest are the quadratic assignment problem and the closely}
\colorbox{BurntOrange}{related graph matching and graph isomorphism problems.}\\

This project will begin by covering how QUBO models are constructed. Then we explore how QUBO models can be applied to the graph matching problem and the related quadratic assignment problem. Finally, we will discuss the application of 'quantum annealers' to solve QUBO problems. 

This project will follow ideas from 'Continuous optimization methods for the graph isomorphism problem' by Stefan Klus and Patrick Gel√ü.

\section{What are QUBO problems?}
A QUBO problem is a problem of form \(f(\mathbf{x}) = \mathbf{x}^T Q \mathbf{x}\) where \(\mathbf{x}\) is a column vector of \(n\) binary variables and \(Q\) is a \(n \times n \) matrix.\\

These are important because many famous optimisation problems can be expressed as QUBO problems. 

\subsection{Example: Sudoku}
\newpage

\section{Graph Isomorphism and Matching problems}
\subsection{The Graph Isomorphism problem}
\colorbox{BurntOrange}{Maybe include summary of what graph isomorphism and matching is?}

First we need to establish some results from \autocite{klus2023continuous}.
\begin{defn}\label{def:1}
    \cite[p.~6]{klus2023continuous} Suppose we have graphs \(G_A\) and \(G_B\) with adjacency matrices \(A\) and \(B\) respectively. The doubly stochastic relaxation of the graph isomorphism problem can be formulated as
    \begin{equation*}
        c_D = \min_{X \in D(n)} ||XA - BX||^2_F
    \end{equation*}
    where \(D(n)\) is the set of doubly stochastic matrices and \(||\cdot||_F\) denotes the Frobenius norm.
\end{defn}

\begin{lem}
    \cite[p.~13]{klus2023continuous} If we penalize non-binary matrices, this problem can be written as \begin{align*}
    \min_{\substack{\mathbf{x}\geq 0 \\ C\mathbf{x} = d \\ H\mathbf{x} = 0}} -\mathbf{x}^T \mathbf{x}
    \end{align*}
    with \(\mathbf{x} = \begin{bmatrix}
        X_1 \\
        \vdots \\
        X_n
    \end{bmatrix}\) where \(X_1, \dots X_n\) are the columns of \(X\) and \(C\), \(d\), and H are defined as shown on \cite[p.~8]{klus2023continuous}.
\end{lem}

\noindent To obtain a QUBO formulation of this problem we can transform the constraints into penalties as shown below.
\begin{center}
\begin{tabular}{ |c|c|c| } 
 \hline
   & Constraint  & Penalty \\ 
 \hline
 1 & \(C\mathbf{x} = d\) & \((C\mathbf{x} - d)\cdot(C\mathbf{x} - d)\) \\ 
 2 & \(H\mathbf{x} = 0\) & \(H \mathbf{x} \cdot H \mathbf{x} \) \\ 
 \hline
\end{tabular}
\end{center}
These penalties are 0 for functions which satisfy the constraints and positively-valued otherwise. Therefore by scaling each penalty by the weights \(\lambda_1\) and \(\lambda_2\) then adding them to the objective function we can ensure that the optimal solution to the QUBO problem corresponds to a isomorphism (if it exists).\\

\noindent Penalty 1 can be simplified to,
\begin{align*}
    (C\mathbf{x} - d)\cdot (C\mathbf{x} - d) &= C\mathbf{x} \cdot C\mathbf{x} - 2d\cdot C\mathbf{x} - d\cdot d \\
    &= \mathbf{x}^T C^T C \mathbf{x} - 2d\cdot Cx - d\cdot d.
\end{align*}
But \(\mathbf{x}\) is a binary vector, so \(\mathbf{x}_i = \mathbf{x}_i^2\) for all \(i\) and therefore the linear term \(-2d\cdot C\mathbf{x}\) can be expressed as a quadratic term. So we can write \(-2d\cdot C \mathbf{x} = -2\mathbf{x}^T\text{diag}(C^Td)\mathbf{x}\) and thus penalty 1 becomes
\begin{align*}
    (C\mathbf{x} - d)\cdot (C\mathbf{x} - d) = \mathbf{x}^T( C^T C -2\text{diag}(C^T d))\mathbf{x} - d\cdot d
\end{align*}
where diag\((v)\) is the function which maps the \(i\)th entry of \(v\) to the \(i\)th diagonal entry of a diagonal matrix.\\

\noindent Penalty 2 can be written as,
\begin{align*}
    H\mathbf{x} \cdot H\mathbf{x} = \mathbf{x}^T H^T H \mathbf{x}.
\end{align*}

\noindent So the QUBO formulation of this problem is 
\begin{align*}
    &-\mathbf{x}^T \mathbf{x} + \lambda_1(C\mathbf{x} - d)\cdot (C\mathbf{x} - d)  +\lambda_2 H\mathbf{x} \cdot H\mathbf{x}\\
    = &-\mathbf{x}^T \mathbf{x} + \lambda_1(\mathbf{x}^T( C^T C -2\text{diag}(C^T d))\mathbf{x} - d\cdot d) + \lambda_2 \mathbf{x}^T H^T H \mathbf{x}\\
    = &\hspace{5pt} \mathbf{x}^T (-I + \lambda_1( C^T C -2\text{diag}(C^T d)) + 
    \lambda_2 H^T H) \mathbf{x} - \lambda_1 d \cdot d.
\end{align*}\\
We can drop the constant \(- \lambda_1 d \cdot d\) at the end and then write the problem as
\begin{align*}
    \min \: f(\mathbf{x}) = \mathbf{x}^T Q \mathbf{x}
\end{align*}
where \(Q = -I + \lambda_1( C^T C -2\text{diag}(C^T d)) + \lambda_2 H^T H\).\\

\noindent Note that the optimal solution of this problem is not necessarily a permutation matrix which corresponds to an isomorphism. So when using software to find a solution we should test the solution we get back against the constraints.

\subsection{Example: Graph Isomorphism problem}




\nocite{*}
\printbibliography % This command prints the cited references.

\end{document}
